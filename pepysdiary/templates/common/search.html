{% extends "base.html" %}
{% load humanize %}

{% block title %}Search{% endblock %}}
{% block header_title %}Search{% endblock %}}


{% block main_content %}

  <form class="form-horizontal">
    <div class="form-group">
      <label for="search-text" class="col-sm-3 control-label">Search for…</label>
      <div class="col-sm-7">
        <input type="text" class="form-control" id="search-text" name="q" value="{% if search_string %}{{ search_string }}{% endif %}">
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-3 control-label"><strong>search in…</strong></div>
      <div class="col-sm-9">
        <div class="radio">
          <label>
            <input type="radio" name="k" value="d"{% if model_name == 'Entry' %}checked{% endif %}> Diary entries
          </label>
        </div>
        <div class="radio">
          <label>
            <input type="radio" name="k" value="l"{% if model_name == 'Letter' %}checked{% endif %}> Letters
          </label>
        </div>
        <div class="radio">
          <label>
            <input type="radio" name="k" value="t"{% if model_name == 'Topic' %}checked{% endif %}>  Encyclopedia topics
          </label>
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-3 control-label"><strong>order by…</strong></div>
      <div class="col-sm-7">
        <select class="form-control" name="o">
          <option value="r"{% if order_string == 'r' or order_string == '' %}selected{% endif %}>Relevancy</option>
          <option value="az"{% if order_string == 'az' %}selected{% endif %}>Title</option>
          <option value="da"{% if order_string == 'da' %}selected{% endif %}>Date (earliest first)</option>
          <option value="dd"{% if order_string == 'dd' %}selected{% endif %}>Date (latest first)</option>
        </select>
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-offset-3 col-sm-9">
        <button type="submit" class="btn btn-primary">Search</button>
      </div>
    </div>
  </form>


  {% if search_string %}
    <hr>
    <p>Searching 
      for <strong>{{ search_string }}</strong>,
      in 
      <strong>{% if model_name == 'Topic' %}encyclopedia topics{% elif model_name == 'Letter' %}letters{% elif model_name == 'Entry' %}diary entries{% endif %}</strong>,
      ordered by <strong>{% if order_string == 'az' %}title{% elif order_string == 'da' %}date (earliest first){% elif order_string == 'dd' %}date (latest first){% else %}relevancy{% endif %}</strong>.
    </p>

    <p>
      {% if paginator.count > 0 %}
        {{ paginator.count|intcomma }} found.
      {% else %}
        Nothing was found.
      {% endif %}
    </p>
  {% endif %}

  {% if page_obj.number > 1 %}
    {% include 'inc/paginator.html' with page_obj=page_obj %}
  {% endif %}

  {% if model_name == 'Letter' %}
    {% include 'letters/inc/letter_list.html' with letter_list=object_list show_intro=False show_years=False %}

  {% else %}
    <ul>
      {% for object in object_list %}
        <li>{% spaceless %}<a href="{{ object.get_absolute_url }}">
          {% if model_name == 'Topic' %}
            {{ object.order_title }}
          {% else %}
            {{ object.title }}
          {% endif %}
          </a>{% endspaceless %}
        </li>
      {% endfor %}
    </ul>
  {% endif %}

  {% include 'inc/paginator.html' with page_obj=page_obj %}

{% endblock main_content %}


{% block sidebar_content %}
	{% load widget_tags %}
	
	{% latest_posts quantity=5 %}

	{% latest_articles quantity=5 %}

	{% latest_topics quantity=5 %}

{% endblock sidebar_content %}

